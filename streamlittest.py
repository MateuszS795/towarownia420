# -*- coding: utf-8 -*-
"""streamlittest.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1e-hqhyXUeLtMyK7n1VcbWVXXHsTuAthv
"""

import streamlit as st

# --- Funkcje do zarzÄ…dzania magazynem ---

def initialize_inventory():
    """Inicjalizuje magazyn w zmiennej session_state Streamlit."""
    if 'inventory' not in st.session_state:
        # PrzykÅ‚adowe poczÄ…tkowe dane
        st.session_state.inventory = [
            {"id": 1, "name": "MÅ‚otek", "quantity": 15},
            {"id": 2, "name": "ÅšrubokrÄ™t krzyÅ¼akowy", "quantity": 30},
            {"id": 3, "name": "Puszka farby (biaÅ‚a)", "quantity": 5},
        ]

def get_next_item_id():
    """Zwraca kolejny dostÄ™pny ID dla nowego towaru."""
    if not st.session_state.inventory:
        return 1
    # Znajduje maksymalny ID i dodaje 1
    return max(item["id"] for item in st.session_state.inventory) + 1

def add_item(name, quantity):
    """Dodaje nowy towar do magazynu."""
    if name and quantity > 0:
        new_id = get_next_item_id()
        st.session_state.inventory.append({
            "id": new_id,
            "name": name,
            "quantity": quantity
        })
        st.success(f"Dodano towar: **{name}** (ID: {new_id})")
    else:
        st.error("Nazwa i iloÅ›Ä‡ muszÄ… byÄ‡ poprawne.")

def delete_item(item_id):
    """Usuwa towar o podanym ID z magazynu."""
    # UÅ¼ywamy list comprehension do stworzenia nowej listy bez usuwanego elementu
    st.session_state.inventory = [
        item for item in st.session_state.inventory if item["id"] != item_id
    ]
    st.warning(f"UsuniÄ™to towar o ID: **{item_id}**")

# --- Interfejs uÅ¼ytkownika Streamlit ---

def main():
    st.set_page_config(page_title="Prosty Magazyn", layout="wide")
    st.title("ğŸ“¦ Prosty System ZarzÄ…dzania Magazynem")

    # Inicjalizacja magazynu przy pierwszym uruchomieniu
    initialize_inventory()

    # --- Kolumny dla lepszego ukÅ‚adu ---
    col1, col2 = st.columns([1, 2])

    # --- Sekcja Dodawania (Kolumna 1) ---
    with col1:
        st.header("â• Dodaj Nowy Towar")

        # Formularz do dodawania towaru
        with st.form("add_item_form", clear_on_submit=True):
            new_name = st.text_input("Nazwa Towaru")
            # UÅ¼ywamy number_input dla iloÅ›ci, upewniajÄ…c siÄ™, Å¼e jest to liczba caÅ‚kowita >= 1
            new_quantity = st.number_input("IloÅ›Ä‡", min_value=1, step=1, value=1)

            submitted = st.form_submit_button("Dodaj do Magazynu")

            if submitted:
                # UÅ¼ywamy funkcji do dodania, aby odÅ›wieÅ¼yÄ‡ stan
                add_item(new_name, int(new_quantity))

    # --- Sekcja Usuwania (Kolumna 1) ---
    with col1:
        st.header("ğŸ—‘ï¸ UsuÅ„ Towar")

        # Pobieramy listÄ™ ID do wyboru
        item_ids = [item["id"] for item in st.session_state.inventory]

        if item_ids:
            # Dropdown do wyboru ID do usuniÄ™cia
            id_to_delete = st.selectbox(
                "Wybierz ID Towaru do usuniÄ™cia",
                options=item_ids,
                index=0
            )

            if st.button("UsuÅ„ Wybrany Towar"):
                delete_item(id_to_delete)
                # Ponowne uruchomienie aplikacji po usuniÄ™ciu (dla lepszego odÅ›wieÅ¼enia selectboxa)
                st.experimental_rerun()
        else:
            st.info("Brak towarÃ³w do usuniÄ™cia.")


    # --- Sekcja WyÅ›wietlania (Kolumna 2) ---
    with col2:
        st.header("ğŸ“‹ Aktualny Stan Magazynu")

        if st.session_state.inventory:
            # WyÅ›wietlenie danych w formie tabeli (data frame)
            # UÅ¼ycie st.dataframe dla Å‚adniejszego i interaktywnego wyÅ›wietlania
            st.dataframe(st.session_state.inventory, use_container_width=True)

            st.markdown(f"**CaÅ‚kowita liczba unikalnych towarÃ³w:** `{len(st.session_state.inventory)}`")
        else:
            st.info("Magazyn jest pusty! Dodaj pierwszy towar.")

if __name__ == "__main__":
    main()